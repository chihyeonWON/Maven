# Maven
Studying Maven by crating Maven Project.

## 자동화 빌드 도구 메이븐

빌드(build)란 무엇일까 소프트웨어 빌드란 소스코드 파일을 컴퓨터에서 실행할 수 있는 독립 소프트웨어 가공물로 변환하는 과정을 말하거나 그에 대한 결과물을 일컫는다.   
프로그래밍 언어를 사용하여 소스코드르 작성하고 나면 실행하기까지 여러 작업이 필요하다.   
빌드는 컴파일보다 훨씬 많은 것을 의미하는데, 테스트를 포함한 소스코드 컴파일 작업, zip 파일이나 자바의 jar 파일 혹은 윈도우의 exe 파일 같은 배포할 수 있는 컴포넌트를 묶는 패키징작업, 버전관리 도구 사용, 자동화된 검사도구 등의 많은 작업을 수행할 수 있다. 이런 작업들은 자동화된 절차에 따라 수행할 수 있어야 한다.  
프로그램을 빌드 하는 과정은 보통 다른 프로그램을 제어하는 프로그램인 빌드 도구에 의해 관리된다.   
빌드 도구로는 메이크, 그래들, 앤트, 메이븐, SBT 등이 있다.   
빌드 도구를 사용하여 자동화 시스템을 구축해 놓는다면 반복 작업과 잦은 야근에서 벗어날 수 있다.   

## 메이븐 개념

메이븐은 유대어로 '지식 축적기'라는 뜻이며, 숙달한 사람, 프로라는 의미로도 사용된다.   
쉽게 말해 소프트웨어를 개발할 때 반복되는 작업을 자동화하는 빌드 도구다.

메이븐의 특징을 알아보도록 한다.

1. 정형화된 구조와 절차를 제공한다.
메이븐은 컴파일, 패키징, 테스트 등의 작업 프로세스를 정형화하고 이를 준수하도록 강제한다. 따라서 공식적인 관례를 가지고 있기 때문에 소스코드의 위치, 바이트 코드의 위치, jar 파일의 위치 등을 알 수 있다.

2. 디펜던시 라이브러리 해결을 자동화한다.
디펜던시는 라이브러리 의존성(혹은 종속성)을 의미한다. 애플리케이션을 실행하기 위해 필요한 라이브러리들과 그 라이브러리들이 필요로 하는 라이브러리들을 가리킨다.
JDK가 제공하는 기본적인 라이브러리 외에 외부 라이브러리를 사용하려면 번거로운 작업을 해야 한다.   
메이븐을 사용하면 의존관계인 라이브러리 관리가 용이하다.   
디펜던시가 있는 라이브러리의 명세만 입력해주면 자동으로 다운로드하여 클래스 패스로 걸어준다.

3. 라이브러리 관리가 용이하다.
일반적으로 프로젝트 진행 시 사용되는 라이브러리를 형상 관리(SCM:Software Configuration Management)도구에서 관리하는 데 이는 불필요한 공간을 낭비할 뿐만 아니라, 버전별로 관리하는것도 어렵다.  
메이븐은 라이브러리 전용 저장소를 제공하므로 통합 관리가 가능하다.

4. 라이프 사이클을 가진다.
메이븐은 라이프 사이클을 가지고 있어서 라이프 사이클에 따라서 연속적으로 단계를 실행한다.   
플러그인의 골(goal)에 따라 라이프 사이클의 각 단계가 실행된다.

5. 다양한 플러그인을 활용할 수 있다.
메이븐은 기본적으로 플러그인으로 기능을 확장한다.   
플러그인을 사용하면 IDE 프로젝트로 자동 변환, 데이터베이스 통합, 다양한 리포트 생성 등의 작업을 수행할 수 있다.   
메이븐은 pom.xml 파일에 위의 내용을 기술한다.   

## 메이븐 특징

메이븐을 사용하는 프로젝트에서는 디펜던시 관리, 로컬 및 원격 저장소 이용, 빌드 로직의 전역적인 재사용 등의 기능을 사용할 수 있으며 프로젝트 산출물들의 쉬운 검색과 필터링이 가능하다.   
1. ProjectObject Model(프로젝트 객체 모델)   
POM은 메이븐의 기본이 되는 모델을 말한다. 이 모델의 일부는 메이븐 엔진에 이미 내장되어 있고 다른 부분은 pom.xml 파일을 통해 선언적으로 만들어 주어야 한다.

2. Dependency Management Model(디펜던시 관리 모델)
메이븐은 프로젝트의 디펜던시가 어떻게 관리되는지 파악한다. 

3. Project Life cycle and Phases(빌드 라이프 사이클과 각 단계)
POM에 관련된 개념으로 빌드 라이프 사이클과 각 단계들이 있다. 메이븐을 사용할 때 대부분의 작업은 플러그인을 사용하여 수행한다.   
메이븐은 잘 정의된 단계들과 빌드 사이클에 따라 이러한 플러그인들을 조율한다.

## 플러그인과 골 (PlugIn & goal)

메이븐 플러그인은 한 개 이상의 골들의 집합이다.   
골은 일종의 작업 단위인 셈이다.   
컴파일되는 과정이나 jar 파일을 만드는 과정 등을 Compiler 플러그인과 jar 플러그인에서 수행하며 메이븐은 필요 시 플러그인을 다운로드하고 메이븐 중앙 저장소에서부터 주기적으로 업데이트를 해준다.

## 라이프 사이클 (Life cycle)

메이븐은 빌드 라이프 사이클이라고 하는 절차를 가진다.      
이는 프로젝트 빌드에 관련된 각 단계의 순서를 의미한다.   
각 단계는 골이 없을 수도 있고 다수의 골을 가질 수도 있다.

## 코디네이트 (coordinates)

코디네이트는 메이븐 프로젝트를 식별하기 위한 유일한 값들을 정의한다.   
코디네이트는 공간 내에서 특정 위치를 위한 주소이다.   
코디네이트는 아래의 정보들로 구성된다.   
1. groupId
프로젝트 제작을 책임지는 개체 또는 조직을 나타낸다.   
이름 명명 규칙에 따르면 groupId는 조직의 도메인을 뒤집어서 표기한다. 예를 들어 com.rubypaper.dev는 groupId가 될 수 있다.

2. artifactId
실제 프로젝트 즉, 아티팩트의 이름을 의미한다. 각 프로젝트를 식별하기 위해 사용된다.

3. version
프로젝트의 특정한 배포 버전을 의미한다. 지원되는 형식은 mmm.nnn.bbb-qqqqqqq-dd 와 같다.
여기에서 mmm은 메이저 버전 숫자, nnn은 마이너 버전 숫자, bbb는 버그 수정 레벨을 나타낸다.   
가끔 qqqqq(수식어) 또는 dd(빌드 숫자)를 버전 번호에 추가로 붙일 수 있다.

4. packaging
프로젝트는 기본적으로 jar형식으로 패키징되며 프로젝트가 만드는 아티팩트로 결정된다.   
만약 war라고 준다면 웹 애플리케이션을 의미한다.
   
이러한 코디네이트 정보를 통해 특정 프로젝트의 아티팩트를 이용할 때 다른 프로젝트에 디펜더시를 추가할 수 있다.   
예로 egov_web이라는 프로젝트를 외부에서 사용하기 위해서는 egov_web 프로젝트를 메이븐 저장소에 배포하고,   
사용하고자 하는 프로젝트의 pom.xml에 디펜던시를 추가하면 된다.

## 저장소

메이븐 저장소는 보통 디렉터리 트리 구조이기 때문에 아티팩트들이 어떻게 저장되어 있는지 쉽게 볼 수 있다.   
표준프레임워크 개발자 통합 개발 환경 설치 시 메이븐 저장소를 다음과 같이 함께 배포한다.
![image](https://user-images.githubusercontent.com/58906858/180130683-17c2043c-1d26-4fab-b13d-7221a23958a8.png)

maven 파일 밑에 있는 settings.xml 설정 파일을 수정해서 사용할 원격 저장소의 위치를 관리할 수도 있다.
![image](https://user-images.githubusercontent.com/58906858/180131031-ac17745c-2d8f-4b95-80a7-8dfff38a744e.png)

기업 내에서 특정 프로젝트에서 사용할 특수한 라이브러리를 사용하고자 할 때 기업 내부의 네트워크 안에 위치한 커스텀 저장소에 이러한 라이브러리를 설정하면 된다.   
기업 내부 사네 개발일 경우 사내 개발 모듈로부터 배포한 아티팩트를 포함하고 있는 커스텀 저장소를 설정할 수 있다.   
settings.xml에 있는 <repositories> 요소를 사용하여 원격 저장소를 추가할 수 있다.

## 디펜던시 관리

프로젝트에 포함된 디펜던시는 pom.xml 파일 안에 <dependencies> 요소를 사용하여 표현하며 POM의 일부로 메이븐에서 사용하게 된다.   
프로젝트 디펜던시들은 저장소에 저장된다.
POM에 있는 프로젝트의 디펜던시 정보를 기반으로 디펜던시 분석기는 다음 순서에 따라 디펜던시를 분석하려고 시도한다.
1. 로컬 저장소에서 디펜던시를 확인한다.
2. 원격 저장소 리스트에서 디펜던시를 확인한다.
3. 1과 2가 실패하면 에러를 보고한다.

기본적으로 두 번째 단계와 관련된 원격 저장소는 세계 어느 곳에서나 접근 가능한 중앙 집중화된 메이븐 저장소이다.   
대부분의 오픈소스 프로젝트에서 사용하는 아티팩트들은 이 곳에 포함되어 있다.   
또한 앞서 소개한 커스텀 저장소가 추가적인 원격 저장소로 더해 질 수 있다.

## pom.xml 파일 구조

pom.xml 파일은 프로젝트의 세부 메타 데이터 정보를 포함하며 크게 10개의 항목으로 구성된다. 프로젝트 일반 정보, 버전 및 설정 관리, 빌드 환경, 라이브러리 저장소 및 디펜던시 등의 내용을 포함하고 있다.

디펜던시 필수 선언 항목은 세가지이다.
1. groupId 2. artifactId 3. version
![image](https://user-images.githubusercontent.com/58906858/180131933-f8ef7c29-6c61-4e7d-9c44-e9478316f002.png)

추가로 scope 항목을 정의할 수 있는 데, JDK나 웹 애플리케이션 서버(AWS)에서 제공하는 라이브러리와 디펜던시에서 선언한 라이브러리 간의 충돌이 일어나는 경우가 발생할 수 있으므로 사용하고자 하는 라이브러리의 스코프를 명시해야 하는 경우가 있다. 다음은 scope의 종류와 범위이다.

1. compile : 기본값으로 모든 클래스 패스에서 사용가능하다.
2. provided : 컴파일과 유사하나 패키지에는 포함되지 않는다. 컨테이너나 JDK에서 제공한다. ex) Servelet API, JSP API
![image](https://user-images.githubusercontent.com/58906858/180132384-a94d61f6-0678-43e4-b968-34e814dd86f3.png)

3. runtime : 컴파일러가 아닌 런타임 시에 사용된다. ex) JDBC drviers
4. test : 테스트 단계에서만 사용된다. ex) JUnit
![image](https://user-images.githubusercontent.com/58906858/180132535-3ec654f4-b8fc-4005-9d16-71e3625f39b1.png)

5. system : provided와 유사하나 개발자가 직접 JAR 파일을 제공해야 하고 저장소에서 지정한 dependency를 찾지 않는다.
![image](https://user-images.githubusercontent.com/58906858/180132562-a1b50ecd-7000-4975-b525-fff84b6d8e5a.png)

디펜던시 scope가 선언되지 않았다면 기본값으로 compile이 적용된다. 디펜던시 분석은 먼저 로컬 저장소에서 디펜던시를 확인하고, 다음으로 원격 저장소 리스트에서 디펜던시를 확인하고, 둘다 실패하면 디펜던시 에러를 발생시킨다.
